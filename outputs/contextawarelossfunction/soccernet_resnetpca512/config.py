classes = [
    'Penalty',
    'Kick-off',
    'Goal',
    'Substitution',
    'Offside',
    'Shots on target',
    'Shots off target',
    'Clearance',
    'Ball out of play',
    'Throw-in',
    'Foul',
    'Indirect free-kick',
    'Direct free-kick',
    'Corner',
    'Yellow card',
    'Red card',
    'Yellow->red card',
]
contextaware_cfg = dict(
    lambda_neg=0.25,
    lambda_pos=2.0,
    lambda_reg=0.5,
    neg_radius=9,
    normalize=True,
    pos_radius=3)
data_root = '/datasets/'
dataset = dict(
    data_root='/datasets/',
    test=dict(
        chunk_size=160,
        chunks_per_epoch=6000,
        classes=[
            'Penalty',
            'Kick-off',
            'Goal',
            'Substitution',
            'Offside',
            'Shots on target',
            'Shots off target',
            'Clearance',
            'Ball out of play',
            'Throw-in',
            'Foul',
            'Indirect free-kick',
            'Direct free-kick',
            'Corner',
            'Yellow card',
            'Red card',
            'Yellow->red card',
        ],
        data_root='/datasets/',
        dataloader=dict(
            batch_size=1, num_workers=1, pin_memory=True, shuffle=False),
        features='ResNET_TF2_PCA512.npy',
        framerate=2,
        metric='loose',
        pipeline=[
            dict(type='LoadFeatureFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
        ],
        receptive_field=40,
        results='results_spotting_test',
        split=[
            'test',
        ],
        type='SoccerNetClipsTestingCALF',
        version=2),
    train=dict(
        chunk_size=160,
        chunks_per_epoch=6000,
        classes=[
            'Penalty',
            'Kick-off',
            'Goal',
            'Substitution',
            'Offside',
            'Shots on target',
            'Shots off target',
            'Clearance',
            'Ball out of play',
            'Throw-in',
            'Foul',
            'Indirect free-kick',
            'Direct free-kick',
            'Corner',
            'Yellow card',
            'Red card',
            'Yellow->red card',
        ],
        data_root='/datasets/',
        dataloader=dict(
            batch_size=256, num_workers=4, pin_memory=True, shuffle=True),
        features='ResNET_TF2_PCA512.npy',
        framerate=2,
        pipeline=[
            dict(type='LoadFeatureFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
        ],
        receptive_field=40,
        split=[
            'train',
        ],
        type='SoccerNetClipsCALF',
        version=2),
    valid=dict(
        chunk_size=160,
        chunks_per_epoch=6000,
        classes=[
            'Penalty',
            'Kick-off',
            'Goal',
            'Substitution',
            'Offside',
            'Shots on target',
            'Shots off target',
            'Clearance',
            'Ball out of play',
            'Throw-in',
            'Foul',
            'Indirect free-kick',
            'Direct free-kick',
            'Corner',
            'Yellow card',
            'Red card',
            'Yellow->red card',
        ],
        data_root='/datasets/',
        dataloader=dict(
            batch_size=256, num_workers=4, pin_memory=True, shuffle=False),
        features='ResNET_TF2_PCA512.npy',
        framerate=2,
        pipeline=[
            dict(type='LoadFeatureFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
        ],
        receptive_field=40,
        split=[
            'valid',
        ],
        type='SoccerNetClipsCALF',
        version=2))
log_level = 'INFO'
model = dict(
    backbone=dict(
        encoder='ResNET_TF2_PCA512',
        feature_dim=512,
        framerate=2,
        output_dim=512,
        type='PreExtactedFeatures'),
    head=dict(
        chunk_size=160,
        dim_capsule=16,
        num_classes=17,
        num_detections=15,
        num_layers=2,
        type='SpottingCALF'),
    load_weights=None,
    neck=dict(
        chunk_size=160,
        dim_capsule=16,
        framerate=2,
        input_size=512,
        num_classes=17,
        num_detections=15,
        receptive_field=40,
        type='CNN++'),
    type='ContextAware')
runner = dict(type='runner_CALF')
training = dict(
    GPU=0,
    batch_size=64,
    criterion=dict(
        loss_1=dict(
            K=[
                [
                    -100,
                    -98,
                    -20,
                    -40,
                    -96,
                    -5,
                    -8,
                    -93,
                    -99,
                    -31,
                    -75,
                    -10,
                    -97,
                    -75,
                    -20,
                    -84,
                    -18,
                ],
                [
                    -50,
                    -49,
                    -10,
                    -20,
                    -48,
                    -3,
                    -4,
                    -46,
                    -50,
                    -15,
                    -37,
                    -5,
                    -49,
                    -38,
                    -10,
                    -42,
                    -9,
                ],
                [
                    50,
                    49,
                    60,
                    10,
                    48,
                    3,
                    4,
                    46,
                    50,
                    15,
                    37,
                    5,
                    49,
                    38,
                    10,
                    42,
                    9,
                ],
                [
                    100,
                    98,
                    90,
                    20,
                    96,
                    5,
                    8,
                    93,
                    99,
                    31,
                    75,
                    10,
                    97,
                    75,
                    20,
                    84,
                    18,
                ],
            ],
            framerate=2,
            hit_radius=0.1,
            miss_radius=0.9,
            neg_radius=9,
            pos_radius=3,
            type='ContextAwareLoss'),
        loss_2=dict(lambda_coord=5.0, lambda_noobj=0.5, type='SpottingLoss'),
        type='Combined2x',
        w_1=0.000367,
        w_2=1.0),
    evaluation_frequency=1000,
    framerate=2,
    max_epochs=200,
    optimizer=dict(
        amsgrad=False,
        betas=(
            0.9,
            0.999,
        ),
        eps=1e-07,
        lr=0.001,
        type='Adam',
        weight_decay=0),
    scheduler=dict(
        LR=0.001,
        LRe=1e-06,
        mode='min',
        patience=25,
        type='ReduceLROnPlateau',
        verbose=True),
    type='trainer_CALF')
work_dir = 'outputs/contextawarelossfunction/soccernet_resnetpca512'
